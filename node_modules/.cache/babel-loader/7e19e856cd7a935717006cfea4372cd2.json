{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\RaulGuillen\\\\Desktop\\\\ONG\\\\pop_rdj_js\\\\src\\\\Container\\\\SingleResultContainer.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Button, Table } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport ModalResults from '../Components/ModalResults';\nimport { db } from '../utils/firebase';\nimport { withRouter } from 'react-router-dom';\nimport Calendar from '../Components/Calendar';\nimport moment from 'moment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst usersData = [];\n\nconst SingleResultContainer = props => {\n  _s();\n\n  const [selectedDays, setSelectedDays] = useState([]);\n  const [arrayUsers, setUsers] = useState([]);\n  const [arrayAws, setAws] = useState([]);\n  const [userTable, setUserTable] = useState([]);\n  const [questions, setQuestions] = useState([]);\n  const [modalShow, setModalShow] = useState(false);\n  const [company, setCompany] = useState({});\n  const [awsToShow, setAwsToShow] = useState({});\n  const [userId, setId] = useState(0);\n\n  const getToFirebase = ref => {\n    db.ref(ref).on('value', snapshot => {\n      const response = snapshot.val();\n\n      switch (ref) {\n        case 'answers':\n          const auxAws = [];\n\n          for (let key in response) {\n            auxAws.push(response[key]);\n          }\n\n          console.log(auxAws); //setAwsToShow(auxAws.filter((data) => data.iduser === userId.id));\n\n          setAws(auxAws);\n          break;\n\n        case 'companies':\n          response.forEach(company => {\n            if (String(company.id) === props.history.location.pathname.substr(9)) {\n              setCompany(company);\n            }\n          });\n          break;\n\n        case 'users':\n          setUsers(response);\n          usersData.push(response);\n          break;\n\n        default:\n          console.log(response);\n          setQuestions(questions);\n          break;\n      }\n    }, error => console.log(error));\n  };\n\n  const getQuestions = () => {\n    db.ref('questions').on('value', snapshot => {\n      const questions = snapshot.val();\n      setQuestions(questions);\n    }, error => console.log(error));\n  };\n\n  useEffect(() => {\n    getQuestions();\n    getToFirebase('companies');\n    getToFirebase('users');\n    getToFirebase('answers'); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    if (selectedDays.length > 0) {\n      const validAnswers = [];\n      arrayUsers.forEach(validUser => {\n        let validAnswer = undefined;\n        arrayAws.forEach(answer => {\n          if (answer.userId === validUser.id) {\n            validAnswer = answer;\n          }\n        });\n        validAnswer && validAnswers.push(validAnswer);\n      });\n      const usersToBlock = [];\n      arrayAws.forEach(item => {\n        if (item.weekToEvaluate[0] === moment(selectedDays[1]).format('LL') && item.weekToEvaluate[1] === moment(selectedDays[5]).format('LL')) {\n          setAwsToShow(item);\n          const user = arrayUsers.find(data => data.id === item.userId && data.company.includes(Number(props.history.location.pathname.substr(9))));\n\n          if (user) {\n            usersToBlock.push(user);\n          }\n        }\n      });\n      setUserTable(usersToBlock);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [selectedDays, arrayAws]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-between p-5\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/results\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            style: {\n              backgroundColor: '#FE3E00',\n              borderBlockColor: '#FE3E00',\n              boxShadow: '#FE3E00',\n              borderBottomColor: '#FE3E00',\n              borderColor: '#FE3E00'\n            },\n            children: \"Regresar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Resultados de \", company.name ? company.name : '...']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex flex-column align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"mb-3\",\n          children: \"Por favor sigue estos sencillos pasos:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-75 mb-4 h4\",\n          children: [/*#__PURE__*/_jsxDEV(\"ol\", {\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Establece la fecha de la gusta ver la evaluaci\\xF3n:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 19\n              }, this), \" Para esto, puedes navegar con las fechas en el calendario para establecer el mes a ver y luego debes dar clic en el calendario sobre la semana que deseas ver.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-center\",\n              children: /*#__PURE__*/_jsxDEV(Calendar, {\n                selectedDays: selectedDays,\n                setSelectedDays: setSelectedDays\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Selecciona persona a ver su resultado:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 19\n              }, this), \" En el siguiente listado, por favor da clic en el bot\\xF3n correspondiente al pasante que deseas ver.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-center\",\n            children: selectedDays.length === 7 ? /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"bg-success text-white rounded px-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Est\\xE1s viendo las evaluaciones de la semana:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 21\n              }, this), moment(selectedDays[1]).format('LL'), \" \\u2013\", ' ', moment(selectedDays[5]).format('LL')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-weight-bold bg-danger text-white rounded px-4\",\n              children: \"A\\xFAn no has establecido una semana para evaluar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), userTable.length === 0 ? /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"No hay evaluaciones en la fecha seleccionada.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 37\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-100\",\n          children: /*#__PURE__*/_jsxDEV(Table, {\n            striped: true,\n            bordered: true,\n            hover: true,\n            className: \" mb-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"text-center d-flex justify-content-around align-items-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: \"Nombre\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"text-center\",\n                  children: \"Accion\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: userTable.map((user, key) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"text-center\",\n                  children: user.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"d-flex justify-content-center\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"primary\",\n                    onClick: () => {\n                      setModalShow(true);\n                      setId(user);\n                    },\n                    style: {\n                      backgroundColor: '#FE3E00',\n                      borderBlockColor: '#FE3E00',\n                      boxShadow: '#FE3E00',\n                      borderBottomColor: '#FE3E00',\n                      borderColor: '#FE3E00'\n                    },\n                    children: \"Ver\"\n                  }, key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 21\n                }, this)]\n              }, key, true, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalResults, {\n        show: modalShow,\n        onHide: () => setModalShow(false),\n        iduser: userId,\n        questions: questions.filter(data => data.userType.includes(userId.type)),\n        aws: awsToShow\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(SingleResultContainer, \"JLrBqL5lELxqox0OKPzdaYwxyCc=\");\n\n_c = SingleResultContainer;\nexport default _c2 = withRouter(SingleResultContainer);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SingleResultContainer\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Users/RaulGuillen/Desktop/ONG/pop_rdj_js/src/Container/SingleResultContainer.js"],"names":["React","useEffect","useState","Button","Table","Link","ModalResults","db","withRouter","Calendar","moment","usersData","SingleResultContainer","props","selectedDays","setSelectedDays","arrayUsers","setUsers","arrayAws","setAws","userTable","setUserTable","questions","setQuestions","modalShow","setModalShow","company","setCompany","awsToShow","setAwsToShow","userId","setId","getToFirebase","ref","on","snapshot","response","val","auxAws","key","push","console","log","forEach","String","id","history","location","pathname","substr","error","getQuestions","length","validAnswers","validUser","validAnswer","undefined","answer","usersToBlock","item","weekToEvaluate","format","user","find","data","includes","Number","backgroundColor","borderBlockColor","boxShadow","borderBottomColor","borderColor","name","map","filter","userType","type"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Button, Table } from 'react-bootstrap';\r\nimport { Link } from 'react-router-dom';\r\nimport ModalResults from '../Components/ModalResults';\r\nimport { db } from '../utils/firebase';\r\nimport { withRouter } from 'react-router-dom';\r\nimport Calendar from '../Components/Calendar';\r\nimport moment from 'moment';\r\n\r\nconst usersData = [];\r\nconst SingleResultContainer = (props) => {\r\n  const [selectedDays, setSelectedDays] = useState([]);\r\n  const [arrayUsers, setUsers] = useState([]);\r\n  const [arrayAws, setAws] = useState([]);\r\n  const [userTable, setUserTable] = useState([]);\r\n  const [questions, setQuestions] = useState([]);\r\n  const [modalShow, setModalShow] = useState(false);\r\n  const [company, setCompany] = useState({});\r\n  const [awsToShow, setAwsToShow] = useState({});\r\n  const [userId, setId] = useState(0);\r\n\r\n  const getToFirebase = (ref) => {\r\n    db.ref(ref).on('value', snapshot => {\r\n      const response = snapshot.val();\r\n      switch (ref) {\r\n        case 'answers':\r\n          const auxAws = [];\r\n          for (let key in response) {\r\n            auxAws.push(response[key]);\r\n          }\r\n          console.log(auxAws);\r\n          //setAwsToShow(auxAws.filter((data) => data.iduser === userId.id));\r\n\r\n          setAws(auxAws);\r\n          break;\r\n        case 'companies':\r\n          response.forEach((company) => {\r\n            if (String(company.id) === props.history.location.pathname.substr(9)) {\r\n              setCompany(company);\r\n            }\r\n          });\r\n          break;\r\n        case 'users':\r\n          setUsers(response);\r\n          usersData.push(response);\r\n          break;\r\n        default:\r\n          console.log(response);\r\n          setQuestions(questions);\r\n          break;\r\n\r\n      }\r\n    }, (error) => console.log(error));\r\n  };\r\n\r\n  const getQuestions = () => {\r\n    db.ref('questions').on('value', snapshot => {\r\n      const questions = snapshot.val();\r\n      setQuestions(questions);\r\n    }, (error) => console.log(error));\r\n  };\r\n\r\n\r\n  useEffect(() => {\r\n    getQuestions();\r\n    getToFirebase('companies');\r\n    getToFirebase('users');\r\n    getToFirebase('answers');\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (selectedDays.length > 0) {\r\n      const validAnswers = [];\r\n      arrayUsers.forEach(validUser => {\r\n        let validAnswer = undefined;\r\n        arrayAws.forEach(answer => {\r\n          if (answer.userId === validUser.id) {\r\n            validAnswer = answer;\r\n          }\r\n        });\r\n        validAnswer && validAnswers.push(validAnswer);\r\n      });\r\n      const usersToBlock = [];\r\n      arrayAws.forEach(item => {\r\n        if (item.weekToEvaluate[0] === moment(selectedDays[1]).format('LL') &&\r\n          item.weekToEvaluate[1] === moment(selectedDays[5]).format('LL')) {\r\n          setAwsToShow(item);\r\n          const user = arrayUsers.find((data) => (data.id === item.userId && data.company.includes(Number(props.history.location.pathname.substr(9)))));\r\n          if (user) {\r\n\r\n            usersToBlock.push(user);\r\n          }\r\n        }\r\n      });\r\n      setUserTable(usersToBlock);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [selectedDays, arrayAws]);\r\n\r\n  return (\r\n    <>\r\n      <div className='container'>\r\n        <div className='d-flex justify-content-between p-5'>\r\n          <Link to='/results'>\r\n            <Button\r\n              variant='primary'\r\n              style={{\r\n                backgroundColor: '#FE3E00',\r\n                borderBlockColor: '#FE3E00',\r\n                boxShadow: '#FE3E00',\r\n                borderBottomColor: '#FE3E00',\r\n                borderColor: '#FE3E00'\r\n              }}\r\n            >\r\n              Regresar\r\n            </Button>\r\n          </Link>\r\n          <h3>Resultados de {company.name ? company.name : '...'}</h3>\r\n        </div>\r\n        <div className='d-flex flex-column align-items-center'>\r\n          <h4 className='mb-3'>Por favor sigue estos sencillos pasos:</h4>\r\n          <div className='w-75 mb-4 h4'>\r\n            <ol>\r\n              <li><strong>Establece la fecha de la gusta ver la evaluación:</strong> Para esto, puedes navegar con las\r\n                fechas en el calendario para establecer el mes a ver y luego debes dar clic en el calendario sobre la\r\n                semana que deseas ver.\r\n              </li>\r\n              <div className='d-flex justify-content-center'>\r\n                <Calendar selectedDays={selectedDays} setSelectedDays={setSelectedDays} />\r\n              </div>\r\n              <li><strong>Selecciona persona a ver su resultado:</strong> En el siguiente listado, por favor da clic en\r\n                el botón correspondiente al pasante que deseas ver.\r\n              </li>\r\n            </ol>\r\n            <div className='d-flex justify-content-center'>\r\n              {selectedDays.length === 7 ? (\r\n                  <h4 className='bg-success text-white rounded px-4'>\r\n                    <strong>Estás viendo las evaluaciones de la semana:</strong>\r\n                    {moment(selectedDays[1]).format('LL')} –{' '}\r\n                    {moment(selectedDays[5]).format('LL')}\r\n                  </h4>\r\n                ) :\r\n                (\r\n                  <h4 className='font-weight-bold bg-danger text-white rounded px-4'>Aún no has establecido una semana\r\n                    para evaluar</h4>\r\n                )\r\n              }\r\n            </div>\r\n          </div>\r\n          {userTable.length === 0 ? <h4>No hay evaluaciones en la fecha seleccionada.</h4> :\r\n            <div className='w-100'>\r\n              <Table striped bordered hover className=' mb-5'>\r\n                <thead>\r\n                <tr>\r\n                  <th className='text-center d-flex justify-content-around align-items-center'>\r\n                    <div>Nombre</div>\r\n                  </th>\r\n                  <th className='text-center'>Accion</th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                {userTable.map((user, key) => (\r\n                  <tr key={key}>\r\n                    <td className='text-center'>{user.name}</td>\r\n                    <td className='d-flex justify-content-center'>\r\n                      <Button\r\n                        variant='primary'\r\n                        onClick={() => {\r\n                          setModalShow(true);\r\n                          setId(user);\r\n                        }}\r\n                        style={{\r\n                          backgroundColor: '#FE3E00',\r\n                          borderBlockColor: '#FE3E00',\r\n                          boxShadow: '#FE3E00',\r\n                          borderBottomColor: '#FE3E00',\r\n                          borderColor: '#FE3E00'\r\n                        }}\r\n                        key={key}\r\n                      >\r\n                        Ver\r\n                      </Button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n                </tbody>\r\n              </Table>\r\n            </div>}\r\n        </div>\r\n\r\n        <ModalResults\r\n          show={modalShow}\r\n          onHide={() => setModalShow(false)}\r\n          iduser={userId}\r\n          questions={questions.filter((data) => data.userType.includes(userId.type))}\r\n          aws={awsToShow}\r\n        />\r\n\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default withRouter(SingleResultContainer);\r\n"]},"metadata":{},"sourceType":"module"}