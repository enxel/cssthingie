{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\RaulGuillen\\\\Desktop\\\\ONG\\\\pop_rdj_js\\\\src\\\\Pages\\\\SingleInternshipPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Button, Container, Modal } from 'react-bootstrap';\nimport { auth, db } from '../utils/firebase';\nimport { Link, useHistory } from 'react-router-dom';\nimport gifTenor from '../Resources/tenor.gif';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst SingleInternshipPage = () => {\n  _s();\n\n  const [intership, setInternship] = useState(null);\n  const [lastApply, setLastApply] = useState(false);\n  const [currentUserData, setCurrentUserData] = useState({});\n  const [candidate, setCandidate] = useState({\n    resume: undefined,\n    imageURL: undefined,\n    flag: false\n  });\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const applyInternship = () => {\n    const currentLoc = window.location.pathname.substr(13);\n    const todoRef = db.ref('internships').child(String(currentLoc));\n\n    if (!intership.candidates) {\n      const candidates = [];\n      const interCandidate = {\n        email: currentUserData.email,\n        resume: candidate.resume,\n        name: currentUserData.name\n      };\n      candidates.push(interCandidate);\n      const intershipToUpdate = intership;\n      intershipToUpdate.candidates = candidates;\n      todoRef.update(intershipToUpdate).then(() => handleShow()).catch(error => alert('error'));\n    } else {\n      const candidates = intership.candidates;\n      const interCandidate = {\n        email: currentUserData.email,\n        resume: candidate.resume\n      };\n      candidates.push(interCandidate);\n      const intershipToUpdate = intership;\n      intershipToUpdate.candidates = candidates;\n      todoRef.update(intershipToUpdate).then(() => handleShow()).catch(error => alert('error'));\n    } //\n    //todoRef.update(newUser).then(() => handleShow()).catch((error) => alert('error'));\n\n  };\n\n  useEffect(() => {\n    db.ref('internships').on('value', data => {\n      const internships = data.val();\n\n      for (let intern of Object.keys(internships)) {\n        const curretnLoc = window.location.pathname.substr(13);\n\n        if (curretnLoc === intern) {\n          setInternship(internships[intern]);\n\n          if (internships[intern].candidates) {\n            for (let candidateA of internships[intern].candidates) {\n              if (candidateA.email === auth.currentUser.email) {\n                setLastApply(true);\n              }\n            }\n          }\n\n          checkRol();\n        }\n      }\n    });\n  }, []);\n\n  const getCandidateResume = currentUser => {\n    db.ref('candidates').on('value', data => {\n      const candidates = data.val();\n\n      for (let intern of Object.keys(candidates)) {\n        if (candidates[intern].email === currentUser.email) {\n          setCandidate(candidates[intern]);\n        }\n      }\n    });\n  };\n\n  const checkRol = () => {\n    db.ref('auth').on('value', snapshot => {\n      const authUsers = snapshot.val();\n      let currentUser = undefined;\n      authUsers.forEach(user => {\n        if (user.email === auth.currentUser.email) {\n          currentUser = user;\n          getCandidateResume(currentUser);\n        }\n      });\n      setCurrentUserData(currentUser);\n    }, error => console.log(error));\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [intership ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-center\",\n        children: intership.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n        children: intership.institution.label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Duracion: \", intership.duration, \" meses.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Modalidad: \", intership.modality]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Descripcion: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: intership.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-center mb-2\",\n        children: currentUserData.rol === 'admin' ? /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"danger\",\n          children: \"Eliminar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"box-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: candidate.flag === false || !candidate.resume || !candidate.photoSettings || lastApply,\n            onClick: applyInternship,\n            className: \"btn rdjf\",\n            children: \"Aplicar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), candidate.flag === false ? '' : candidate.resume && candidate.photoSettings ? '' : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Necesitas agregar tu CV y una foto de ti antes de aplicar a una pasant\\xEDa.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 15\n          }, this), lastApply ? /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Ya has aplicado a esta pasantia.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 26\n          }, this) : '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 18\n    }, this) : '', /*#__PURE__*/_jsxDEV(Modal, {\n      show: show,\n      onHide: handleClose,\n      \"aria-labelledby\": \"contained-modal-title-vcenter\",\n      centered: true,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"Formulario enviado\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex flex-column justify-content-center align-items-center\",\n          children: [\"Datos guardados correctamente.\", ' ', /*#__PURE__*/_jsxDEV(\"img\", {\n            src: gifTenor,\n            alt: \"\",\n            width: 100\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            onClick: handleClose,\n            style: {\n              backgroundColor: '#FE3E00',\n              borderBlockColor: '#FE3E00',\n              boxShadow: '#FE3E00',\n              borderBottomColor: '#FE3E00',\n              borderColor: '#FE3E00'\n            },\n            children: \"Aceptar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 11\n  }, this);\n};\n\n_s(SingleInternshipPage, \"TCGY+dAyYqhYQ41fyVSO08ybtkI=\");\n\n_c = SingleInternshipPage;\nexport default SingleInternshipPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"SingleInternshipPage\");","map":{"version":3,"sources":["C:/Users/RaulGuillen/Desktop/ONG/pop_rdj_js/src/Pages/SingleInternshipPage.js"],"names":["React","useEffect","useState","Button","Container","Modal","auth","db","Link","useHistory","gifTenor","SingleInternshipPage","intership","setInternship","lastApply","setLastApply","currentUserData","setCurrentUserData","candidate","setCandidate","resume","undefined","imageURL","flag","show","setShow","handleClose","handleShow","applyInternship","currentLoc","window","location","pathname","substr","todoRef","ref","child","String","candidates","interCandidate","email","name","push","intershipToUpdate","update","then","catch","error","alert","on","data","internships","val","intern","Object","keys","curretnLoc","candidateA","currentUser","checkRol","getCandidateResume","snapshot","authUsers","forEach","user","console","log","institution","label","duration","modality","description","rol","photoSettings","backgroundColor","borderBlockColor","boxShadow","borderBottomColor","borderColor"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Button, Container, Modal } from 'react-bootstrap';\r\nimport { auth, db } from '../utils/firebase';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport gifTenor from '../Resources/tenor.gif';\r\n\r\nconst SingleInternshipPage = () => {\r\n  const [intership, setInternship] = useState(null);\r\n  const [lastApply, setLastApply] = useState(false);\r\n  const [currentUserData, setCurrentUserData] = useState({});\r\n  const [candidate, setCandidate] = useState({ resume: undefined, imageURL: undefined, flag: false });\r\n  const [show, setShow] = useState(false);\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n  const applyInternship = () => {\r\n    const currentLoc = window.location.pathname.substr(13);\r\n    const todoRef = db.ref('internships').child(String(currentLoc));\r\n    if (!intership.candidates) {\r\n      const candidates = [];\r\n      const interCandidate = { email: currentUserData.email, resume: candidate.resume, name: currentUserData.name };\r\n      candidates.push(interCandidate);\r\n      const intershipToUpdate = intership;\r\n      intershipToUpdate.candidates = candidates;\r\n      todoRef.update(intershipToUpdate).then(() => handleShow()).catch((error) => alert('error'));\r\n    } else {\r\n      const candidates = intership.candidates;\r\n      const interCandidate = { email: currentUserData.email, resume: candidate.resume };\r\n      candidates.push(interCandidate);\r\n      const intershipToUpdate = intership;\r\n      intershipToUpdate.candidates = candidates;\r\n      todoRef.update(intershipToUpdate).then(() => handleShow()).catch((error) => alert('error'));\r\n    }\r\n    //\r\n    //todoRef.update(newUser).then(() => handleShow()).catch((error) => alert('error'));\r\n  };\r\n  useEffect(() => {\r\n    db.ref('internships').on('value', data => {\r\n      const internships = data.val();\r\n      for (let intern of Object.keys(internships)) {\r\n        const curretnLoc = window.location.pathname.substr(13);\r\n        if (curretnLoc === intern) {\r\n          setInternship(internships[intern]);\r\n          if (internships[intern].candidates) {\r\n            for (let candidateA of internships[intern].candidates) {\r\n              if (candidateA.email === auth.currentUser.email) {\r\n                setLastApply(true);\r\n              }\r\n            }\r\n          }\r\n          checkRol();\r\n        }\r\n      }\r\n    });\r\n\r\n  }, []);\r\n  const getCandidateResume = (currentUser) => {\r\n    db.ref('candidates').on('value', data => {\r\n      const candidates = data.val();\r\n      for (let intern of Object.keys(candidates)) {\r\n        if (candidates[intern].email === currentUser.email) {\r\n          setCandidate(candidates[intern]);\r\n        }\r\n      }\r\n    });\r\n  };\r\n  const checkRol = () => {\r\n    db.ref('auth').on('value', snapshot => {\r\n      const authUsers = snapshot.val();\r\n      let currentUser = undefined;\r\n      authUsers.forEach(user => {\r\n        if (user.email === auth.currentUser.email) {\r\n          currentUser = user;\r\n          getCandidateResume(currentUser);\r\n        }\r\n      });\r\n      setCurrentUserData(currentUser);\r\n    }, (error) => console.log(error));\r\n  };\r\n  return (<Container>\r\n    {intership ? <div>\r\n      <h2 className='text-center'>{intership.name}</h2>\r\n      <h5>{intership.institution.label}</h5>\r\n      <p>Duracion: {intership.duration} meses.</p>\r\n      <p>Modalidad: {intership.modality}</p>\r\n\r\n      <strong>Descripcion: </strong>\r\n      <p>{intership.description}</p>\r\n      <div className='d-flex justify-content-center mb-2'>\r\n        {currentUserData.rol === 'admin' ?\r\n          <Button variant='danger'>Eliminar</Button> :\r\n          <div className='box-container'>\r\n            <button disabled={candidate.flag === false || !candidate.resume || !candidate.photoSettings || lastApply}\r\n                    onClick={applyInternship} className='btn rdjf'>Aplicar\r\n            </button>\r\n            {candidate.flag === false ? '' : candidate.resume && candidate.photoSettings ? '' :\r\n              <p>Necesitas agregar tu CV y una foto de ti antes de aplicar a una pasantía.</p>}\r\n            {lastApply ? <p>Ya has aplicado a esta pasantia.</p> : ''}\r\n          </div>}</div>\r\n\r\n    </div> : ''}\r\n    <Modal\r\n      show={show}\r\n      onHide={handleClose}\r\n      aria-labelledby='contained-modal-title-vcenter'\r\n      centered\r\n    >\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>Formulario enviado</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <div className='d-flex flex-column justify-content-center align-items-center'>\r\n          Datos guardados correctamente.{' '}\r\n          <img src={gifTenor} alt='' width={100} />\r\n        </div>\r\n      </Modal.Body>\r\n      <Modal.Footer>\r\n        <Link to='/'>\r\n          <Button\r\n            variant='primary'\r\n            onClick={handleClose}\r\n            style={{\r\n              backgroundColor: '#FE3E00',\r\n              borderBlockColor: '#FE3E00',\r\n              boxShadow: '#FE3E00',\r\n              borderBottomColor: '#FE3E00',\r\n              borderColor: '#FE3E00'\r\n            }}\r\n          >\r\n            Aceptar\r\n          </Button></Link>\r\n      </Modal.Footer>\r\n    </Modal>\r\n  </Container>);\r\n};\r\nexport default SingleInternshipPage;\r\n"]},"metadata":{},"sourceType":"module"}